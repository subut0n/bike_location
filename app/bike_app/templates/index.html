{% extends 'base.html' %}

{% block body %}

<section class="presentation">
    <p>Cette page permet d'obtenir une prediction en direct de l'utilisation du reseau de velos en libre service VLille en fonction des donnees meteorologiques ! </p>
</section>

<main class="daily-recap">

    <section class='meteo-now'>
        <div class="date">
            <h3>Date du jour:</h3>
            <p>{{ data[0]['dt'] }}</p>
        </div>
        <div class="weather">
            <h3>Conditions meteorologiques :</h3>
                <p>
                    {% for i in range(4) %}
                        {% if data[0]['weather_' + (i+1)|string] != 0%}
                            {{ data[0]['weather_' + (i+1)|string] }}
                        {% endif %}
                    {% endfor %}
                </p>
        </div>
        <div class="temperature">
            <h3>Temperature :</h3>
            <p>{{ data[0]['temp'] }}</p>
        </div>
        <div class="atemperature">
            <h3>Temperature ressentie :</h3>
            <p>{{ data[0]['atemp'] }}</p>
        </div>
        <div class="windforce">
            <h3>Force du vent :</h3>
            <p>{{ data[0]['windspeed'] }}</p>
        </div>
        <div class="humidity">
            <h3>Humidite :</h3>
            <p>{{ data[0]['humidity'] }}</p>
        </div>

        <div class="registered">
            <h3>Number of registered :</h3>
            <p>{{ pred[0]|int }}</p>
        </div>
    </section>

    <section class="meteo-48h">
        <div>
            <canvas id="myChart" style="width:100%;max-width:1000px;height:600px;"></canvas>
        </div>
        <script>
            var xValues = [];
            {% for dict in data %}
                xValues.push({{ dict['hours'] }});
            {% endfor %}

            var yValues = {{ pred }};
            var color = ["red"];
            
            new Chart("myChart", {
                type: "bar",
                data: {
                    labels: xValues,
                    datasets: [{
                    label: "Predicted number of registered",
                    backgroundColor: color,
                    data: yValues
                    }]
                },
                options: {
                    plugins: {
                        title: {
                            font: {
                                    size: 36
                            },
                            display: true,
                            text: 'Predicted number of registered as a function of time'
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                font: {
                                    size: 22
                                },
                                display: true,
                                text: 'Predicted number of registered'
                            }
                        },
                        x: {
                            title: {
                                font: {
                                    size: 22
                                },
                                display: true,
                                text: 'Time : hour'
                            }
                        }
                    }
                }
            });
        </script>
    </section>
</main>

{% endblock %}